syntax = "proto3";

import "google/protobuf/struct.proto";
import "google/protobuf/empty.proto";
import "v1/model.proto";
import "v1/cmd.proto";

option java_multiple_files = true;
option java_package = "gov.nist.csd.pm.proto.v1.adjudication";

package gov.nist.csd.pm.proto.v1.adjudication;

// AdminAdjudicationService adjudicates administrative operation commands.
service AdminAdjudicationService {
  // Adjudicate a given operation request and return the output value.
  rpc AdjudicateOperation(OperationRequest) returns (gov.nist.csd.pm.proto.v1.model.Value);

  // Adjudicate the list of admin commands in order. Any error will cause the
  // entire transaction to be rolled back.
  rpc AdjudicateRoutine(RoutineRequest) returns (google.protobuf.Empty);
}

// ResourceAdjudicationService adjudicates resource commands and returns a Value
// if the provided operation returns one.
service ResourceAdjudicationService {
  rpc AdjudicateResourceOperation(OperationRequest) returns (gov.nist.csd.pm.proto.v1.model.Value);
}

// RoutineRequest stores an array of AdminOperationCommands.
message RoutineRequest {
  repeated gov.nist.csd.pm.proto.v1.cmd.AdminOperationCommand commands = 1;
}

// OperationCmd stores an operation name and arguments.
message OperationRequest {
  string opName = 1;
  gov.nist.csd.pm.proto.v1.model.ValueMap args = 2;
}