syntax = "proto3";

import "v1/model.proto";

option java_multiple_files = true;
option java_package = "gov.nist.csd.pm.proto.v1.pdp.adjudication";

package gov.nist.csd.pm.proto.v1.pdp.adjudication;

// AdminAdjudicationService adjudicates administrative operation commands.
service AdminAdjudicationService {
  // Adjudicate a given operation request and return the output value.
  rpc adjudicateOperation(OperationRequest) returns (AdjudicateOperationResponse);

  // Adjudicate the list of admin commands in order. Any error will cause the
  // entire transaction to be rolled back.
  rpc adjudicateRoutine(RoutineRequest) returns (AdjudicateRoutineResponse);
}

// ResourceAdjudicationService adjudicates resource commands and returns a Value
// if the provided operation returns one.
service ResourceAdjudicationService {
  rpc adjudicateResourceOperation(OperationRequest) returns (AdjudicateOperationResponse);
}

// OperationRequest stores the name and args of an operation invocation.
message OperationRequest {
  string name = 1;
  gov.nist.csd.pm.proto.v1.model.ValueMap args = 2;
}

// AdjudicateOperationResponse stores the value returned from adjudicating an operation.
message AdjudicateOperationResponse {
  gov.nist.csd.pm.proto.v1.model.Value value = 1;
}

// RoutineRequest stores an array of OperationRequests.
message RoutineRequest {
  repeated OperationRequest operations = 1;
}

// AdjudicateRoutineResponse is an empty response for the AdjudicateRoutine rpc.
message AdjudicateRoutineResponse {
}



